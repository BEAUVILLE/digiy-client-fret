<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>DIGIY FRET ‚Äî Client & Chauffeur</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#16a34a" />
  <meta name="description" content="DIGIY FRET ‚Äî Colis, bagages, marchandises. Client + Chauffeur." />

  <style>
    body{margin:0;font-family:system-ui,-apple-system,Arial,sans-serif;background:#f7fbf8;color:#0f172a}
    header{background:#16a34a;color:#fff;padding:18px;text-align:center;font-weight:900;font-size:18px}
    main{max-width:860px;margin:auto;padding:16px}
    .card{background:#fff;border-radius:18px;padding:16px;margin-bottom:14px;box-shadow:0 10px 22px rgba(2,6,23,.08)}
    .tabs{display:flex;gap:10px;margin-bottom:14px}
    .tab{flex:1;padding:12px;border:none;border-radius:14px;font-weight:900;cursor:pointer;background:#e5e7eb}
    .tab.active{background:#0b3d2e;color:#fff}
    label{font-size:12px;font-weight:800;color:#475569;display:block;margin-bottom:6px}
    input,select{width:100%;padding:12px;border-radius:14px;border:1px solid rgba(15,23,42,.15);font-size:15px;margin-bottom:14px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media(max-width:640px){.grid{grid-template-columns:1fr}}
    .actions{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px}
    button.action{padding:14px;border:none;border-radius:14px;font-weight:900;cursor:pointer}
    .accept{background:#16a34a;color:#fff}
    .secondary{background:#e5e7eb}
    .price{font-size:26px;font-weight:950;color:#065f46;text-align:center;margin:10px 0}
    .note{font-size:13px;color:#475569;text-align:center;margin-top:10px}
    .hidden{display:none}
  </style>
</head>

<body>
<header>üì¶ DIGIY FRET</header>

<main>

  <div class="tabs">
    <button class="tab active" id="tabClient" onclick="showView('client')">üë§ Client</button>
    <button class="tab" id="tabDriver" onclick="showView('driver')">üöö Chauffeur</button>
  </div>

  <!-- ‚úÖ VUE CLIENT -->
  <section id="viewClient" class="card">
    <h3 style="margin:0 0 10px 0;">üë§ Client ‚Äî Demande FRET</h3>

    <label>Ville</label>
    <input id="city" placeholder="Dakar, Saly‚Ä¶" value="Dakar" />

    <label>Volume (estimation)</label>
    <select id="volume">
      <option value="S">S ‚Äî Petit</option>
      <option value="M" selected>M ‚Äî Moyen</option>
      <option value="L">L ‚Äî Grand</option>
      <option value="XL">XL ‚Äî Tr√®s grand</option>
    </select>

    <label>Urgence</label>
    <select id="urgency">
      <option value="URGENT">‚ö° URGENT</option>
      <option value="24H" selected>üïí 24H</option>
      <option value="48H">üïí 48H</option>
    </select>

    <div class="grid">
      <div>
        <label>Distance estim√©e (km)</label>
        <input id="distance" type="number" step="0.1" value="4" />
      </div>
      <div>
        <label>Dur√©e estim√©e (min)</label>
        <input id="duration" type="number" value="12" />
      </div>
    </div>

    <div class="price" id="price">‚Äî</div>
    <button class="action accept" onclick="estimateLocal()">üßÆ Estimer (d√©mo locale)</button>

    <div class="note">Pour brancher Supabase : on ajoute RPC + cr√©ation de demande.</div>
  </section>

  <!-- ‚úÖ VUE CHAUFFEUR -->
  <section id="viewDriver" class="card hidden">
    <h3 style="margin:0 0 10px 0;">üöö Chauffeur ‚Äî Proposition</h3>

    <div class="card" style="margin:0 0 12px 0;">
      <strong>üìç Dakar ‚Üí Plateau</strong><br>
      üì¶ Volume : L<br>
      ‚è±Ô∏è Urgence : 24H<br>
      üí∞ Prix base : 4 500 F CFA
    </div>

    <div class="actions">
      <button class="action accept">‚úÖ ACCEPTER</button>
      <button class="action secondary">üïí PROPOSER HEURE</button>
      <button class="action secondary">üìÖ PROPOSER DEMAIN</button>
      <button class="action secondary">üí∞ PROPOSER PRIX</button>
    </div>

    <div class="note">Ensuite on branche Supabase : accept / propose.</div>
  </section>

</main>

<script>
function showView(which){
  const vc = document.getElementById("viewClient");
  const vd = document.getElementById("viewDriver");
  const tc = document.getElementById("tabClient");
  const td = document.getElementById("tabDriver");

  if(which === "client"){
    vc.classList.remove("hidden");
    vd.classList.add("hidden");
    tc.classList.add("active");
    td.classList.remove("active");
  }else{
    vd.classList.remove("hidden");
    vc.classList.add("hidden");
    td.classList.add("active");
    tc.classList.remove("active");
  }
}

// D√©mo locale (juste pour que tu voies l'UX). Supabase arrive juste apr√®s.
function estimateLocal(){
  const km = parseFloat(document.getElementById("distance").value || "0");
  const min = parseInt(document.getElementById("duration").value || "0", 10);
  const vol = document.getElementById("volume").value;
  const urg = document.getElementById("urgency").value;

  const volMult = {S:1.0, M:1.15, L:1.3, XL:1.55}[vol] || 1.15;
  const urgAdd  = {URGENT:800, "24H":0, "48H":-200}[urg] ?? 0;

  const base = 1500;
  const perKm = 320;
  const perMin = 60;
  let price = (base + km*perKm + min*perMin + urgAdd) * volMult;

  // plancher
  const floor = (vol === "XL") ? 6000 : (vol === "L") ? 4500 : (vol === "M") ? 3500 : 3000;
  price = Math.max(Math.round(price), floor);

  document.getElementById("price").innerText = price + " F CFA";
}
</script>
  <script>
function showView(which){
  const vc = document.getElementById("viewClient");
  const vd = document.getElementById("viewDriver");
  const tc = document.getElementById("tabClient");
  const td = document.getElementById("tabDriver");

  if(which === "client"){
    vc.classList.remove("hidden");
    vd.classList.add("hidden");
    tc.classList.add("active");
    td.classList.remove("active");
  }else{
    vd.classList.remove("hidden");
    vc.classList.add("hidden");
    td.classList.add("active");
    tc.classList.remove("active");
  }
}

// D√©mo locale (juste pour que tu voies l'UX). Supabase arrive juste apr√®s.
function estimateLocal(){
  const km = parseFloat(document.getElementById("distance").value || "0");
  const min = parseInt(document.getElementById("duration").value || "0", 10);
  const vol = document.getElementById("volume").value;
  const urg = document.getElementById("urgency").value;

  const volMult = {S:1.0, M:1.15, L:1.3, XL:1.55}[vol] || 1.15;
  const urgAdd  = {URGENT:800, "24H":0, "48H":-200}[urg] ?? 0;

  const base = 1500;
  const perKm = 320;
  const perMin = 60;
  let price = (base + km*perKm + min*perMin + urgAdd) * volMult;

  // plancher
  const floor = (vol === "XL") ? 6000 : (vol === "L") ? 4500 : (vol === "M") ? 3500 : 3000;
  price = Math.max(Math.round(price), floor);

  document.getElementById("price").innerText = price + " F CFA";
}

// ‚úÖ Ouvre automatiquement Client ou Chauffeur selon l'URL
const view = new URLSearchParams(location.search).get("view");
if(view === "driver") showView("driver");
if(view === "client") showView("client");
</script>

</body>
</html>
